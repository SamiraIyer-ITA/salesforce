{
    "nodes":  {
                  "Task: Filter Relative Fiscal Year":  {
                                                            "action":  "filter",
                                                            "parameters":  {
                                                                               "filter":  "Relative_Fiscal_Year:EQ:Current Fiscal Year|Previous Fiscal Year|2 Fiscal Years Ago"
                                                                           },
                                                            "sources":  [
                                                                            "Task: Add formulas"
                                                                        ]
                                                        },
                  "Task: 2 FY Ago: Filter IsLastOrder":  {
                                                             "action":  "filter",
                                                             "parameters":  {
                                                                                "filter":  "IsLastOrder:EQ:true"
                                                                            },
                                                             "sources":  [
                                                                             "Task: 2 FY Ago: Add IsLastOrder"
                                                                         ]
                                                         },
                  "Task: Add formulas":  {
                                             "action":  "computeExpression",
                                             "parameters":  {
                                                                "computedFields":  [
                                                                                       {
                                                                                           "label":  "Promotion",
                                                                                           "name":  "Promotion",
                                                                                           "saqlExpression":  "case\n    when \u0027Investment_Promotion__c\u0027 == \"true\" then \"Investment Promotion\"\n    else \"Export Promotion\"\nend",
                                                                                           "type":  "Text"
                                                                                       },
                                                                                       {
                                                                                           "label":  "Fiscal Year",
                                                                                           "name":  "Fiscal_Year",
                                                                                           "saqlExpression":  "\u0027Actual_Create_Date__c_Year_Fiscal\u0027",
                                                                                           "type":  "Text"
                                                                                       },
                                                                                       {
                                                                                           "label":  "Contributor ID",
                                                                                           "name":  "Contributor_ID",
                                                                                           "saqlExpression":  "\u0027OwnerId\u0027",
                                                                                           "type":  "Text"
                                                                                       },
                                                                                       {
                                                                                           "label":  "Contributor",
                                                                                           "name":  "Contributor",
                                                                                           "saqlExpression":  "\u0027Contributor.Name\u0027",
                                                                                           "type":  "Text"
                                                                                       },
                                                                                       {
                                                                                           "label":  "Relative Fiscal Year",
                                                                                           "name":  "Relative_Fiscal_Year",
                                                                                           "saqlExpression":  "case\n    when toDate(\u0027Actual_Create_Date__c_sec_epoch\u0027) in [\"current fiscal_year\", \"current fiscal_year\"] then \"Current Fiscal Year\"\n    when toDate(\u0027Actual_Create_Date__c_sec_epoch\u0027) in [\"1 fiscal_year ago\", \"1 fiscal_year ago\"] then \"Previous Fiscal Year\"\n    when toDate(\u0027Actual_Create_Date__c_sec_epoch\u0027) in [\"2 fiscal_years ago\", \"2 fiscal_years ago\"] then \"2 Fiscal Years Ago\"\nend ",
                                                                                           "type":  "Text"
                                                                                       },
                                                                                       {
                                                                                           "label":  "DAS",
                                                                                           "name":  "DAS",
                                                                                           "saqlExpression":  "case\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM Advocacy Everywhere\" then \"Advocacy\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM CS-Asia-HQ DAS Office\" then \"Asia\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM CS-China-HQ DAS Office\" then \"China\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM CS-EUR-HQ DAS Office\" then \"Europe\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM CS-MEA-HQ DAS Office\" then \"MEA\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM CS-USA-HQ DAS Office\" then \"U.S.\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM CS-WH-HQ DAS Office\" then \"WH\"\n\twhen \u0027RH_Lev_2_DAS__c\u0027 == \"GM SelectUSA Everywhere\" then \"SUSA\"\n\telse \u0027RH_Lev_2_DAS__c\u0027\nend",
                                                                                           "type":  "Text"
                                                                                       }
                                                                                   ],
                                                                "mergeWithSource":  true
                                                            },
                                             "sources":  [
                                                             "Task: Join Contributor"
                                                         ]
                                         },
                  "Task: Current FY: Filter Investment Promotion":  {
                                                                        "action":  "filter",
                                                                        "parameters":  {
                                                                                           "filter":  "Promotion:EQ:Investment Promotion"
                                                                                       },
                                                                        "sources":  [
                                                                                        "Task: Filter Current Fiscal Year"
                                                                                    ]
                                                                    },
                  "Task: Current FY: Export Promotion: Keep Fields":  {
                                                                          "action":  "sliceDataset",
                                                                          "parameters":  {
                                                                                             "fields":  [
                                                                                                            {
                                                                                                                "name":  "AccountId"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.Actual_Create_Date__c"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.Contributor"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.Contributor_ID"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.DAS"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.Fiscal_Year"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.Promotion"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.Relative_Fiscal_Year"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.RH_Lev_1_GM_All__c"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.RH_Lev_2_DAS__c"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.RH_Lev_3_Region_2__c"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.RH_Lev_4_Region_1__c"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.RH_Lev_5_Country__c"
                                                                                                            },
                                                                                                            {
                                                                                                                "name":  "Tasks.RH_Lev_6_Office__c"
                                                                                                            }
                                                                                                        ],
                                                                                             "mode":  "select"
                                                                                         },
                                                                          "sources":  [
                                                                                          "Task: Current FY: Export Promotion: Filter IsLastOrder"
                                                                                      ]
                                                                      },
                  "Task: Previous FY: Export Promotion: Keep Fields":  {
                                                                           "action":  "sliceDataset",
                                                                           "parameters":  {
                                                                                              "fields":  [
                                                                                                             {
                                                                                                                 "name":  "AccountId"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.Actual_Create_Date__c"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.Contributor"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.Contributor_ID"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.DAS"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.Fiscal_Year"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.Promotion"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.Relative_Fiscal_Year"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.RH_Lev_1_GM_All__c"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.RH_Lev_2_DAS__c"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.RH_Lev_3_Region_2__c"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.RH_Lev_4_Region_1__c"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.RH_Lev_5_Country__c"
                                                                                                             },
                                                                                                             {
                                                                                                                 "name":  "Tasks.RH_Lev_6_Office__c"
                                                                                                             }
                                                                                                         ],
                                                                                              "mode":  "select"
                                                                                          },
                                                                           "sources":  [
                                                                                           "Task: Previous FY: Export Promotion: Filter IsLastOrder"
                                                                                       ]
                                                                       },
                  "Task: Current FY: Filter Export Promotion":  {
                                                                    "action":  "filter",
                                                                    "parameters":  {
                                                                                       "filter":  "Promotion:EQ:Export Promotion"
                                                                                   },
                                                                    "sources":  [
                                                                                    "Task: Filter Current Fiscal Year"
                                                                                ]
                                                                },
                  "User: Load":  {
                                     "action":  "sobjectDigest",
                                     "parameters":  {
                                                        "fields":  [
                                                                       {
                                                                           "name":  "Id"
                                                                       },
                                                                       {
                                                                           "name":  "FirstName"
                                                                       },
                                                                       {
                                                                           "name":  "LastName"
                                                                       }
                                                                   ],
                                                        "incremental":  true,
                                                        "object":  "User"
                                                    }
                                 },
                  "Task: Current FY: Flatten":  {
                                                    "action":  "flatten",
                                                    "parameters":  {
                                                                       "includeSelfId":  true,
                                                                       "multiField":  {
                                                                                          "name":  "Tasks"
                                                                                      },
                                                                       "parentField":  "Flatten_Parent_ID",
                                                                       "pathField":  {
                                                                                         "name":  "Tasks_Path"
                                                                                     },
                                                                       "selfField":  "Flatten_Self_ID"
                                                                   },
                                                    "sources":  [
                                                                    "Task: Current FY: Add Flatten IDs"
                                                                ]
                                                },
                  "Task: Current FY: Investment Promotion: Add Flatten IDs":  {
                                                                                  "action":  "computeExpression",
                                                                                  "parameters":  {
                                                                                                     "computedFields":  [
                                                                                                                            {
                                                                                                                                "label":  "Flatten: Self ID",
                                                                                                                                "name":  "Flatten_Self_ID",
                                                                                                                                "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                                                "type":  "Text"
                                                                                                                            },
                                                                                                                            {
                                                                                                                                "label":  "Flatten: Parent ID",
                                                                                                                                "name":  "Flatten_Parent_ID",
                                                                                                                                "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                                                "type":  "Text"
                                                                                                                            }
                                                                                                                        ],
                                                                                                     "mergeWithSource":  true
                                                                                                 },
                                                                                  "sources":  [
                                                                                                  "Task: Current FY: Investment Promotion: Add Order"
                                                                                              ]
                                                                              },
                  "Task: Current FY: Export Promotion: Join flattened Task":  {
                                                                                  "action":  "augment",
                                                                                  "parameters":  {
                                                                                                     "leftKey":  [
                                                                                                                     "Tasks"
                                                                                                                 ],
                                                                                                     "operation":  "LookupMultiValue",
                                                                                                     "relationship":  "Tasks",
                                                                                                     "rightKey":  [
                                                                                                                      "Flatten_Self_ID"
                                                                                                                  ],
                                                                                                     "rightSelect":  [
                                                                                                                         "Actual_Create_Date__c",
                                                                                                                         "Contributor",
                                                                                                                         "Contributor_ID",
                                                                                                                         "DAS",
                                                                                                                         "Fiscal_Year",
                                                                                                                         "Relative_Fiscal_Year",
                                                                                                                         "RH_Lev_1_GM_All__c",
                                                                                                                         "RH_Lev_2_DAS__c",
                                                                                                                         "RH_Lev_3_Region_2__c",
                                                                                                                         "RH_Lev_4_Region_1__c",
                                                                                                                         "RH_Lev_5_Country__c",
                                                                                                                         "RH_Lev_6_Office__c",
                                                                                                                         "Investment_Promotion__c",
                                                                                                                         "Promotion"
                                                                                                                     ]
                                                                                                 },
                                                                                  "sources":  [
                                                                                                  "Task: Current FY: Export Promotion: Flatten",
                                                                                                  "Task: Current FY: Export Promotion: Flatten"
                                                                                              ]
                                                                              },
                  "Task: 2 FY Ago: Export Promotion: Flatten":  {
                                                                    "action":  "flatten",
                                                                    "parameters":  {
                                                                                       "includeSelfId":  true,
                                                                                       "multiField":  {
                                                                                                          "name":  "Tasks"
                                                                                                      },
                                                                                       "parentField":  "Flatten_Parent_ID",
                                                                                       "pathField":  {
                                                                                                         "name":  "Tasks_Path"
                                                                                                     },
                                                                                       "selfField":  "Flatten_Self_ID"
                                                                                   },
                                                                    "sources":  [
                                                                                    "Task: 2 FY Ago: Export Promotion: Add Flatten IDs"
                                                                                ]
                                                                },
                  "Task: Current FY: Investment Promotion: Add Order":  {
                                                                            "action":  "computeRelative",
                                                                            "parameters":  {
                                                                                               "computedFields":  [
                                                                                                                      {
                                                                                                                          "expression":  {
                                                                                                                                             "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                                             "type":  "Numeric",
                                                                                                                                             "scale":  10
                                                                                                                                         },
                                                                                                                          "label":  "Order",
                                                                                                                          "name":  "Order"
                                                                                                                      }
                                                                                                                  ],
                                                                                               "orderBy":  [
                                                                                                               {
                                                                                                                   "direction":  "asc",
                                                                                                                   "name":  "Id"
                                                                                                               }
                                                                                                           ],
                                                                                               "partitionBy":  [
                                                                                                                   "AccountId"
                                                                                                               ]
                                                                                           },
                                                                            "sources":  [
                                                                                            "Task: Current FY: Filter Investment Promotion"
                                                                                        ]
                                                                        },
                  "Task: 2 FY Ago: Investment Promotion: Filter IsLastOrder":  {
                                                                                   "action":  "filter",
                                                                                   "parameters":  {
                                                                                                      "filter":  "IsLastOrder:EQ:true"
                                                                                                  },
                                                                                   "sources":  [
                                                                                                   "Task: 2 FY Ago: Investment Promotion: Add IsLastOrder"
                                                                                               ]
                                                                               },
                  "Task: Filter 2 Fiscal Years Ago":  {
                                                          "action":  "filter",
                                                          "parameters":  {
                                                                             "filter":  "Relative_Fiscal_Year:EQ:2 Fiscal Years Ago"
                                                                         },
                                                          "sources":  [
                                                                          "Task: Filter Relative Fiscal Year"
                                                                      ]
                                                      },
                  "Task: Previous FY: Export Promotion: Join flattened Task":  {
                                                                                   "action":  "augment",
                                                                                   "parameters":  {
                                                                                                      "leftKey":  [
                                                                                                                      "Tasks"
                                                                                                                  ],
                                                                                                      "operation":  "LookupMultiValue",
                                                                                                      "relationship":  "Tasks",
                                                                                                      "rightKey":  [
                                                                                                                       "Flatten_Self_ID"
                                                                                                                   ],
                                                                                                      "rightSelect":  [
                                                                                                                          "Actual_Create_Date__c",
                                                                                                                          "Contributor",
                                                                                                                          "Contributor_ID",
                                                                                                                          "DAS",
                                                                                                                          "Fiscal_Year",
                                                                                                                          "Relative_Fiscal_Year",
                                                                                                                          "RH_Lev_1_GM_All__c",
                                                                                                                          "RH_Lev_2_DAS__c",
                                                                                                                          "RH_Lev_3_Region_2__c",
                                                                                                                          "RH_Lev_4_Region_1__c",
                                                                                                                          "RH_Lev_5_Country__c",
                                                                                                                          "RH_Lev_6_Office__c",
                                                                                                                          "Investment_Promotion__c",
                                                                                                                          "Promotion"
                                                                                                                      ]
                                                                                                  },
                                                                                   "sources":  [
                                                                                                   "Task: Previous FY: Export Promotion: Flatten",
                                                                                                   "Task: Previous FY: Export Promotion: Flatten"
                                                                                               ]
                                                                               },
                  "Task: 2 FY Ago: Filter Investment Promotion":  {
                                                                      "action":  "filter",
                                                                      "parameters":  {
                                                                                         "filter":  "Promotion:EQ:Investment Promotion"
                                                                                     },
                                                                      "sources":  [
                                                                                      "Task: Filter 2 Fiscal Years Ago"
                                                                                  ]
                                                                  },
                  "Task: Previous FY: Investment Promotion: Add Flatten IDs":  {
                                                                                   "action":  "computeExpression",
                                                                                   "parameters":  {
                                                                                                      "computedFields":  [
                                                                                                                             {
                                                                                                                                 "label":  "Flatten: Self ID",
                                                                                                                                 "name":  "Flatten_Self_ID",
                                                                                                                                 "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                                                 "type":  "Text"
                                                                                                                             },
                                                                                                                             {
                                                                                                                                 "label":  "Flatten: Parent ID",
                                                                                                                                 "name":  "Flatten_Parent_ID",
                                                                                                                                 "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                                                 "type":  "Text"
                                                                                                                             }
                                                                                                                         ],
                                                                                                      "mergeWithSource":  true
                                                                                                  },
                                                                                   "sources":  [
                                                                                                   "Task: Previous FY: Investment Promotion: Add Order"
                                                                                               ]
                                                                               },
                  "Task: Current FY: Investment Promotion: Join flattened Task":  {
                                                                                      "action":  "augment",
                                                                                      "parameters":  {
                                                                                                         "leftKey":  [
                                                                                                                         "Tasks"
                                                                                                                     ],
                                                                                                         "operation":  "LookupMultiValue",
                                                                                                         "relationship":  "Tasks",
                                                                                                         "rightKey":  [
                                                                                                                          "Flatten_Self_ID"
                                                                                                                      ],
                                                                                                         "rightSelect":  [
                                                                                                                             "Actual_Create_Date__c",
                                                                                                                             "Contributor",
                                                                                                                             "Contributor_ID",
                                                                                                                             "DAS",
                                                                                                                             "Fiscal_Year",
                                                                                                                             "Relative_Fiscal_Year",
                                                                                                                             "RH_Lev_1_GM_All__c",
                                                                                                                             "RH_Lev_2_DAS__c",
                                                                                                                             "RH_Lev_3_Region_2__c",
                                                                                                                             "RH_Lev_4_Region_1__c",
                                                                                                                             "RH_Lev_5_Country__c",
                                                                                                                             "RH_Lev_6_Office__c",
                                                                                                                             "Investment_Promotion__c",
                                                                                                                             "Promotion"
                                                                                                                         ]
                                                                                                     },
                                                                                      "sources":  [
                                                                                                      "Task: Current FY: Investment Promotion: Flatten",
                                                                                                      "Task: Current FY: Investment Promotion: Flatten"
                                                                                                  ]
                                                                                  },
                  "Task: Previous FY: Export Promotion: Flatten":  {
                                                                       "action":  "flatten",
                                                                       "parameters":  {
                                                                                          "includeSelfId":  true,
                                                                                          "multiField":  {
                                                                                                             "name":  "Tasks"
                                                                                                         },
                                                                                          "parentField":  "Flatten_Parent_ID",
                                                                                          "pathField":  {
                                                                                                            "name":  "Tasks_Path"
                                                                                                        },
                                                                                          "selfField":  "Flatten_Self_ID"
                                                                                      },
                                                                       "sources":  [
                                                                                       "Task: Previous FY: Export Promotion: Add Flatten IDs"
                                                                                   ]
                                                                   },
                  "Task: 2 FY Ago: Investment Promotion: Add Flatten IDs":  {
                                                                                "action":  "computeExpression",
                                                                                "parameters":  {
                                                                                                   "computedFields":  [
                                                                                                                          {
                                                                                                                              "label":  "Flatten: Self ID",
                                                                                                                              "name":  "Flatten_Self_ID",
                                                                                                                              "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                                              "type":  "Text"
                                                                                                                          },
                                                                                                                          {
                                                                                                                              "label":  "Flatten: Parent ID",
                                                                                                                              "name":  "Flatten_Parent_ID",
                                                                                                                              "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                                              "type":  "Text"
                                                                                                                          }
                                                                                                                      ],
                                                                                                   "mergeWithSource":  true
                                                                                               },
                                                                                "sources":  [
                                                                                                "Task: 2 FY Ago: Investment Promotion: Add Order"
                                                                                            ]
                                                                            },
                  "Task: 2 FY Ago: Export Promotion: Join flattened Task":  {
                                                                                "action":  "augment",
                                                                                "parameters":  {
                                                                                                   "leftKey":  [
                                                                                                                   "Tasks"
                                                                                                               ],
                                                                                                   "operation":  "LookupMultiValue",
                                                                                                   "relationship":  "Tasks",
                                                                                                   "rightKey":  [
                                                                                                                    "Flatten_Self_ID"
                                                                                                                ],
                                                                                                   "rightSelect":  [
                                                                                                                       "Actual_Create_Date__c",
                                                                                                                       "Contributor",
                                                                                                                       "Contributor_ID",
                                                                                                                       "DAS",
                                                                                                                       "Fiscal_Year",
                                                                                                                       "Relative_Fiscal_Year",
                                                                                                                       "RH_Lev_1_GM_All__c",
                                                                                                                       "RH_Lev_2_DAS__c",
                                                                                                                       "RH_Lev_3_Region_2__c",
                                                                                                                       "RH_Lev_4_Region_1__c",
                                                                                                                       "RH_Lev_5_Country__c",
                                                                                                                       "RH_Lev_6_Office__c",
                                                                                                                       "Investment_Promotion__c",
                                                                                                                       "Promotion"
                                                                                                                   ]
                                                                                               },
                                                                                "sources":  [
                                                                                                "Task: 2 FY Ago: Export Promotion: Flatten",
                                                                                                "Task: 2 FY Ago: Export Promotion: Flatten"
                                                                                            ]
                                                                            },
                  "Task: Previous FY: Join flattened Task":  {
                                                                 "action":  "augment",
                                                                 "parameters":  {
                                                                                    "leftKey":  [
                                                                                                    "Tasks"
                                                                                                ],
                                                                                    "operation":  "LookupMultiValue",
                                                                                    "relationship":  "Related",
                                                                                    "rightKey":  [
                                                                                                     "Flatten_Self_ID"
                                                                                                 ],
                                                                                    "rightSelect":  [
                                                                                                        "AccountId",
                                                                                                        "Tasks.Actual_Create_Date__c",
                                                                                                        "Tasks.Contributor",
                                                                                                        "Tasks.Contributor_ID",
                                                                                                        "Tasks.DAS",
                                                                                                        "Tasks.Fiscal_Year",
                                                                                                        "Tasks.Promotion",
                                                                                                        "Tasks.Relative_Fiscal_Year",
                                                                                                        "Tasks.RH_Lev_1_GM_All__c",
                                                                                                        "Tasks.RH_Lev_2_DAS__c",
                                                                                                        "Tasks.RH_Lev_3_Region_2__c",
                                                                                                        "Tasks.RH_Lev_4_Region_1__c",
                                                                                                        "Tasks.RH_Lev_5_Country__c",
                                                                                                        "Tasks.RH_Lev_6_Office__c"
                                                                                                    ]
                                                                                },
                                                                 "sources":  [
                                                                                 "Task: Previous FY: Flatten",
                                                                                 "Task: Previous FY: Flatten"
                                                                             ]
                                                             },
                  "Task: Previous FY: Flatten":  {
                                                     "action":  "flatten",
                                                     "parameters":  {
                                                                        "includeSelfId":  true,
                                                                        "multiField":  {
                                                                                           "name":  "Tasks"
                                                                                       },
                                                                        "parentField":  "Flatten_Parent_ID",
                                                                        "pathField":  {
                                                                                          "name":  "Tasks_Path"
                                                                                      },
                                                                        "selfField":  "Flatten_Self_ID"
                                                                    },
                                                     "sources":  [
                                                                     "Task: Previous FY: Add Flatten IDs"
                                                                 ]
                                                 },
                  "Task: 2 FY Ago: Investment Promotion: Add IsLastOrder":  {
                                                                                "action":  "computeRelative",
                                                                                "parameters":  {
                                                                                                   "computedFields":  [
                                                                                                                          {
                                                                                                                              "expression":  {
                                                                                                                                                 "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                                                 "type":  "Text"
                                                                                                                                             },
                                                                                                                              "label":  "Is Last Order",
                                                                                                                              "name":  "IsLastOrder"
                                                                                                                          }
                                                                                                                      ],
                                                                                                   "orderBy":  [
                                                                                                                   {
                                                                                                                       "direction":  "desc",
                                                                                                                       "name":  "Order"
                                                                                                                   }
                                                                                                               ],
                                                                                                   "partitionBy":  [
                                                                                                                       "AccountId"
                                                                                                                   ]
                                                                                               },
                                                                                "sources":  [
                                                                                                "Task: 2 FY Ago: Investment Promotion: Join flattened Task"
                                                                                            ]
                                                                            },
                  "Task: Previous FY: Keep Fields":  {
                                                         "action":  "sliceDataset",
                                                         "parameters":  {
                                                                            "fields":  [
                                                                                           {
                                                                                               "name":  "AccountId"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.Actual_Create_Date__c"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.Contributor"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.Contributor_ID"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.DAS"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.Fiscal_Year"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.Promotion"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.Relative_Fiscal_Year"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.RH_Lev_1_GM_All__c"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.RH_Lev_2_DAS__c"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.RH_Lev_3_Region_2__c"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.RH_Lev_4_Region_1__c"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.RH_Lev_5_Country__c"
                                                                                           },
                                                                                           {
                                                                                               "name":  "Related.Tasks.RH_Lev_6_Office__c"
                                                                                           }
                                                                                       ],
                                                                            "mode":  "select"
                                                                        },
                                                         "sources":  [
                                                                         "Task: Previous FY: Filter IsLastOrder"
                                                                     ]
                                                     },
                  "Task: Current FY: Investment Promotion: Keep Fields":  {
                                                                              "action":  "sliceDataset",
                                                                              "parameters":  {
                                                                                                 "fields":  [
                                                                                                                {
                                                                                                                    "name":  "AccountId"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.Actual_Create_Date__c"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.Contributor"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.Contributor_ID"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.DAS"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.Fiscal_Year"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.Promotion"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.Relative_Fiscal_Year"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.RH_Lev_1_GM_All__c"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.RH_Lev_2_DAS__c"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.RH_Lev_3_Region_2__c"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.RH_Lev_4_Region_1__c"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.RH_Lev_5_Country__c"
                                                                                                                },
                                                                                                                {
                                                                                                                    "name":  "Tasks.RH_Lev_6_Office__c"
                                                                                                                }
                                                                                                            ],
                                                                                                 "mode":  "select"
                                                                                             },
                                                                              "sources":  [
                                                                                              "Task: Current FY: Investment Promotion: Filter IsLastOrder"
                                                                                          ]
                                                                          },
                  "Task: Current FY: Export Promotion: Add Order":  {
                                                                        "action":  "computeRelative",
                                                                        "parameters":  {
                                                                                           "computedFields":  [
                                                                                                                  {
                                                                                                                      "expression":  {
                                                                                                                                         "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                                         "type":  "Numeric",
                                                                                                                                         "scale":  10
                                                                                                                                     },
                                                                                                                      "label":  "Order",
                                                                                                                      "name":  "Order"
                                                                                                                  }
                                                                                                              ],
                                                                                           "orderBy":  [
                                                                                                           {
                                                                                                               "direction":  "asc",
                                                                                                               "name":  "Id"
                                                                                                           }
                                                                                                       ],
                                                                                           "partitionBy":  [
                                                                                                               "AccountId"
                                                                                                           ]
                                                                                       },
                                                                        "sources":  [
                                                                                        "Task: Current FY: Filter Export Promotion"
                                                                                    ]
                                                                    },
                  "Task: Previous FY: Filter Investment Promotion":  {
                                                                         "action":  "filter",
                                                                         "parameters":  {
                                                                                            "filter":  "Promotion:EQ:Investment Promotion"
                                                                                        },
                                                                         "sources":  [
                                                                                         "Task: Filter Previous Fiscal Year"
                                                                                     ]
                                                                     },
                  "Task: Previous FY: Investment Promotion: Keep Fields":  {
                                                                               "action":  "sliceDataset",
                                                                               "parameters":  {
                                                                                                  "fields":  [
                                                                                                                 {
                                                                                                                     "name":  "AccountId"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.Actual_Create_Date__c"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.Contributor"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.Contributor_ID"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.DAS"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.Fiscal_Year"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.Promotion"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.Relative_Fiscal_Year"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.RH_Lev_1_GM_All__c"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.RH_Lev_2_DAS__c"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.RH_Lev_3_Region_2__c"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.RH_Lev_4_Region_1__c"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.RH_Lev_5_Country__c"
                                                                                                                 },
                                                                                                                 {
                                                                                                                     "name":  "Tasks.RH_Lev_6_Office__c"
                                                                                                                 }
                                                                                                             ],
                                                                                                  "mode":  "select"
                                                                                              },
                                                                               "sources":  [
                                                                                               "Task: Previous FY: Investment Promotion: Filter IsLastOrder"
                                                                                           ]
                                                                           },
                  "Task: Previous FY: Investment Promotion: Add IsLastOrder":  {
                                                                                   "action":  "computeRelative",
                                                                                   "parameters":  {
                                                                                                      "computedFields":  [
                                                                                                                             {
                                                                                                                                 "expression":  {
                                                                                                                                                    "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                                                    "type":  "Text"
                                                                                                                                                },
                                                                                                                                 "label":  "Is Last Order",
                                                                                                                                 "name":  "IsLastOrder"
                                                                                                                             }
                                                                                                                         ],
                                                                                                      "orderBy":  [
                                                                                                                      {
                                                                                                                          "direction":  "desc",
                                                                                                                          "name":  "Order"
                                                                                                                      }
                                                                                                                  ],
                                                                                                      "partitionBy":  [
                                                                                                                          "AccountId"
                                                                                                                      ]
                                                                                                  },
                                                                                   "sources":  [
                                                                                                   "Task: Previous FY: Investment Promotion: Join flattened Task"
                                                                                               ]
                                                                               },
                  "Task: Join Contributor":  {
                                                 "action":  "augment",
                                                 "parameters":  {
                                                                    "leftKey":  [
                                                                                    "OwnerId"
                                                                                ],
                                                                    "operation":  "LookupSingleValue",
                                                                    "relationship":  "Contributor",
                                                                    "rightKey":  [
                                                                                     "Id"
                                                                                 ],
                                                                    "rightSelect":  [
                                                                                        "Name"
                                                                                    ]
                                                                },
                                                 "sources":  [
                                                                 "Task: Filter IsDeleted, GM All, Related to Case",
                                                                 "User: Add formulas"
                                                             ]
                                             },
                  "Task: Current FY: Add Flatten IDs":  {
                                                            "action":  "computeExpression",
                                                            "parameters":  {
                                                                               "computedFields":  [
                                                                                                      {
                                                                                                          "label":  "Flatten: Self ID",
                                                                                                          "name":  "Flatten_Self_ID",
                                                                                                          "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                          "type":  "Text"
                                                                                                      },
                                                                                                      {
                                                                                                          "label":  "Flatten: Parent ID",
                                                                                                          "name":  "Flatten_Parent_ID",
                                                                                                          "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                          "type":  "Text"
                                                                                                      }
                                                                                                  ],
                                                                               "mergeWithSource":  true
                                                                           },
                                                            "sources":  [
                                                                            "Task: Current FY: Add Order"
                                                                        ]
                                                        },
                  "Task: Previous FY: Investment Promotion: Filter IsLastOrder":  {
                                                                                      "action":  "filter",
                                                                                      "parameters":  {
                                                                                                         "filter":  "IsLastOrder:EQ:true"
                                                                                                     },
                                                                                      "sources":  [
                                                                                                      "Task: Previous FY: Investment Promotion: Add IsLastOrder"
                                                                                                  ]
                                                                                  },
                  "Task: Current FY: Export Promotion: Flatten":  {
                                                                      "action":  "flatten",
                                                                      "parameters":  {
                                                                                         "includeSelfId":  true,
                                                                                         "multiField":  {
                                                                                                            "name":  "Tasks"
                                                                                                        },
                                                                                         "parentField":  "Flatten_Parent_ID",
                                                                                         "pathField":  {
                                                                                                           "name":  "Tasks_Path"
                                                                                                       },
                                                                                         "selfField":  "Flatten_Self_ID"
                                                                                     },
                                                                      "sources":  [
                                                                                      "Task: Current FY: Export Promotion: Add Flatten IDs"
                                                                                  ]
                                                                  },
                  "Task: Previous FY: Save Tasks":  {
                                                        "action":  "register",
                                                        "parameters":  {
                                                                           "label":  "TEST: Tasks: Previous Fiscal Year",
                                                                           "name":  "TEST_Tasks_Previuos_Fiscal_Year"
                                                                       },
                                                        "sources":  [
                                                                        "Task: Previous FY: Keep Fields"
                                                                    ]
                                                    },
                  "Task: Filter Previous Fiscal Year":  {
                                                            "action":  "filter",
                                                            "parameters":  {
                                                                               "filter":  "Relative_Fiscal_Year:EQ:Previous Fiscal Year"
                                                                           },
                                                            "sources":  [
                                                                            "Task: Filter Relative Fiscal Year"
                                                                        ]
                                                        },
                  "Task: Previous FY: Union Promotions":  {
                                                              "action":  "append",
                                                              "parameters":  {
                                                                                 "enableDisjointedSchemaMerge":  false
                                                                             },
                                                              "sources":  [
                                                                              "Task: Previous FY: Export Promotion: Keep Fields",
                                                                              "Task: Previous FY: Investment Promotion: Keep Fields"
                                                                          ]
                                                          },
                  "Task: 2 FY Ago: Investment Promotion: Flatten":  {
                                                                        "action":  "flatten",
                                                                        "parameters":  {
                                                                                           "includeSelfId":  true,
                                                                                           "multiField":  {
                                                                                                              "name":  "Tasks"
                                                                                                          },
                                                                                           "parentField":  "Flatten_Parent_ID",
                                                                                           "pathField":  {
                                                                                                             "name":  "Tasks_Path"
                                                                                                         },
                                                                                           "selfField":  "Flatten_Self_ID"
                                                                                       },
                                                                        "sources":  [
                                                                                        "Task: 2 FY Ago: Investment Promotion: Add Flatten IDs"
                                                                                    ]
                                                                    },
                  "Task: 2 FY Ago: Flatten":  {
                                                  "action":  "flatten",
                                                  "parameters":  {
                                                                     "includeSelfId":  true,
                                                                     "multiField":  {
                                                                                        "name":  "Tasks"
                                                                                    },
                                                                     "parentField":  "Flatten_Parent_ID",
                                                                     "pathField":  {
                                                                                       "name":  "Tasks_Path"
                                                                                   },
                                                                     "selfField":  "Flatten_Self_ID"
                                                                 },
                                                  "sources":  [
                                                                  "Task: 2 FY Ago: Add Flatten IDs"
                                                              ]
                                              },
                  "Task: Current FY: Union Promotions":  {
                                                             "action":  "append",
                                                             "parameters":  {
                                                                                "enableDisjointedSchemaMerge":  false
                                                                            },
                                                             "sources":  [
                                                                             "Task: Current FY: Export Promotion: Keep Fields",
                                                                             "Task: Current FY: Investment Promotion: Keep Fields"
                                                                         ]
                                                         },
                  "Task: Current FY: Export Promotion: Add IsLastOrder":  {
                                                                              "action":  "computeRelative",
                                                                              "parameters":  {
                                                                                                 "computedFields":  [
                                                                                                                        {
                                                                                                                            "expression":  {
                                                                                                                                               "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                                               "type":  "Text"
                                                                                                                                           },
                                                                                                                            "label":  "Is Last Order",
                                                                                                                            "name":  "IsLastOrder"
                                                                                                                        }
                                                                                                                    ],
                                                                                                 "orderBy":  [
                                                                                                                 {
                                                                                                                     "direction":  "desc",
                                                                                                                     "name":  "Order"
                                                                                                                 }
                                                                                                             ],
                                                                                                 "partitionBy":  [
                                                                                                                     "AccountId"
                                                                                                                 ]
                                                                                             },
                                                                              "sources":  [
                                                                                              "Task: Current FY: Export Promotion: Join flattened Task"
                                                                                          ]
                                                                          },
                  "Task: Previous FY: Investment Promotion: Add Order":  {
                                                                             "action":  "computeRelative",
                                                                             "parameters":  {
                                                                                                "computedFields":  [
                                                                                                                       {
                                                                                                                           "expression":  {
                                                                                                                                              "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                                              "type":  "Numeric",
                                                                                                                                              "scale":  10
                                                                                                                                          },
                                                                                                                           "label":  "Order",
                                                                                                                           "name":  "Order"
                                                                                                                       }
                                                                                                                   ],
                                                                                                "orderBy":  [
                                                                                                                {
                                                                                                                    "direction":  "asc",
                                                                                                                    "name":  "Id"
                                                                                                                }
                                                                                                            ],
                                                                                                "partitionBy":  [
                                                                                                                    "AccountId"
                                                                                                                ]
                                                                                            },
                                                                             "sources":  [
                                                                                             "Task: Previous FY: Filter Investment Promotion"
                                                                                         ]
                                                                         },
                  "Task: Current FY: Filter IsLastOrder":  {
                                                               "action":  "filter",
                                                               "parameters":  {
                                                                                  "filter":  "IsLastOrder:EQ:true"
                                                                              },
                                                               "sources":  [
                                                                               "Task: Current FY: Add IsLastOrder"
                                                                           ]
                                                           },
                  "Task: Previous FY: Export Promotion: Add Order":  {
                                                                         "action":  "computeRelative",
                                                                         "parameters":  {
                                                                                            "computedFields":  [
                                                                                                                   {
                                                                                                                       "expression":  {
                                                                                                                                          "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                                          "type":  "Numeric",
                                                                                                                                          "scale":  10
                                                                                                                                      },
                                                                                                                       "label":  "Order",
                                                                                                                       "name":  "Order"
                                                                                                                   }
                                                                                                               ],
                                                                                            "orderBy":  [
                                                                                                            {
                                                                                                                "direction":  "asc",
                                                                                                                "name":  "Id"
                                                                                                            }
                                                                                                        ],
                                                                                            "partitionBy":  [
                                                                                                                "AccountId"
                                                                                                            ]
                                                                                        },
                                                                         "sources":  [
                                                                                         "Task: Previous FY: Filter Export Promotion"
                                                                                     ]
                                                                     },
                  "Task: 2 FY Ago: Investment Promotion: Keep Fields":  {
                                                                            "action":  "sliceDataset",
                                                                            "parameters":  {
                                                                                               "fields":  [
                                                                                                              {
                                                                                                                  "name":  "AccountId"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.Actual_Create_Date__c"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.Contributor"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.Contributor_ID"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.DAS"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.Fiscal_Year"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.Promotion"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.Relative_Fiscal_Year"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.RH_Lev_1_GM_All__c"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.RH_Lev_2_DAS__c"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.RH_Lev_3_Region_2__c"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.RH_Lev_4_Region_1__c"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.RH_Lev_5_Country__c"
                                                                                                              },
                                                                                                              {
                                                                                                                  "name":  "Tasks.RH_Lev_6_Office__c"
                                                                                                              }
                                                                                                          ],
                                                                                               "mode":  "select"
                                                                                           },
                                                                            "sources":  [
                                                                                            "Task: 2 FY Ago: Investment Promotion: Filter IsLastOrder"
                                                                                        ]
                                                                        },
                  "Task: Previous FY: Export Promotion: Add IsLastOrder":  {
                                                                               "action":  "computeRelative",
                                                                               "parameters":  {
                                                                                                  "computedFields":  [
                                                                                                                         {
                                                                                                                             "expression":  {
                                                                                                                                                "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                                                "type":  "Text"
                                                                                                                                            },
                                                                                                                             "label":  "Is Last Order",
                                                                                                                             "name":  "IsLastOrder"
                                                                                                                         }
                                                                                                                     ],
                                                                                                  "orderBy":  [
                                                                                                                  {
                                                                                                                      "direction":  "desc",
                                                                                                                      "name":  "Order"
                                                                                                                  }
                                                                                                              ],
                                                                                                  "partitionBy":  [
                                                                                                                      "AccountId"
                                                                                                                  ]
                                                                                              },
                                                                               "sources":  [
                                                                                               "Task: Previous FY: Export Promotion: Join flattened Task"
                                                                                           ]
                                                                           },
                  "Task: 2 FY Ago: Add Flatten IDs":  {
                                                          "action":  "computeExpression",
                                                          "parameters":  {
                                                                             "computedFields":  [
                                                                                                    {
                                                                                                        "label":  "Flatten: Self ID",
                                                                                                        "name":  "Flatten_Self_ID",
                                                                                                        "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                        "type":  "Text"
                                                                                                    },
                                                                                                    {
                                                                                                        "label":  "Flatten: Parent ID",
                                                                                                        "name":  "Flatten_Parent_ID",
                                                                                                        "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                        "type":  "Text"
                                                                                                    }
                                                                                                ],
                                                                             "mergeWithSource":  true
                                                                         },
                                                          "sources":  [
                                                                          "Task: 2 FY Ago: Add Order"
                                                                      ]
                                                      },
                  "User: Add formulas":  {
                                             "action":  "computeExpression",
                                             "parameters":  {
                                                                "computedFields":  [
                                                                                       {
                                                                                           "label":  "Name",
                                                                                           "name":  "Name",
                                                                                           "saqlExpression":  "\u0027LastName\u0027 + \", \" + \u0027FirstName\u0027",
                                                                                           "type":  "Text"
                                                                                       }
                                                                                   ],
                                                                "mergeWithSource":  true
                                                            },
                                             "sources":  [
                                                             "User: Load"
                                                         ]
                                         },
                  "Task: Current FY: Keep Fields":  {
                                                        "action":  "sliceDataset",
                                                        "parameters":  {
                                                                           "fields":  [
                                                                                          {
                                                                                              "name":  "AccountId"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.Actual_Create_Date__c"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.Contributor"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.Contributor_ID"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.DAS"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.Fiscal_Year"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.Promotion"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.Relative_Fiscal_Year"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.RH_Lev_1_GM_All__c"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.RH_Lev_2_DAS__c"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.RH_Lev_3_Region_2__c"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.RH_Lev_4_Region_1__c"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.RH_Lev_5_Country__c"
                                                                                          },
                                                                                          {
                                                                                              "name":  "Related.Tasks.RH_Lev_6_Office__c"
                                                                                          }
                                                                                      ],
                                                                           "mode":  "select"
                                                                       },
                                                        "sources":  [
                                                                        "Task: Current FY: Filter IsLastOrder"
                                                                    ]
                                                    },
                  "Task: Previous FY: Filter IsLastOrder":  {
                                                                "action":  "filter",
                                                                "parameters":  {
                                                                                   "filter":  "IsLastOrder:EQ:true"
                                                                               },
                                                                "sources":  [
                                                                                "Task: Previous FY: Add IsLastOrder"
                                                                            ]
                                                            },
                  "Task: Previous FY: Filter Export Promotion":  {
                                                                     "action":  "filter",
                                                                     "parameters":  {
                                                                                        "filter":  "Promotion:EQ:Export Promotion"
                                                                                    },
                                                                     "sources":  [
                                                                                     "Task: Filter Previous Fiscal Year"
                                                                                 ]
                                                                 },
                  "Task: Current FY: Investment Promotion: Filter IsLastOrder":  {
                                                                                     "action":  "filter",
                                                                                     "parameters":  {
                                                                                                        "filter":  "IsLastOrder:EQ:true"
                                                                                                    },
                                                                                     "sources":  [
                                                                                                     "Task: Current FY: Investment Promotion: Add IsLastOrder"
                                                                                                 ]
                                                                                 },
                  "Task: Current FY: Export Promotion: Filter IsLastOrder":  {
                                                                                 "action":  "filter",
                                                                                 "parameters":  {
                                                                                                    "filter":  "IsLastOrder:EQ:true"
                                                                                                },
                                                                                 "sources":  [
                                                                                                 "Task: Current FY: Export Promotion: Add IsLastOrder"
                                                                                             ]
                                                                             },
                  "Task: Current FY: Join flattened Task":  {
                                                                "action":  "augment",
                                                                "parameters":  {
                                                                                   "leftKey":  [
                                                                                                   "Tasks"
                                                                                               ],
                                                                                   "operation":  "LookupMultiValue",
                                                                                   "relationship":  "Related",
                                                                                   "rightKey":  [
                                                                                                    "Flatten_Self_ID"
                                                                                                ],
                                                                                   "rightSelect":  [
                                                                                                       "AccountId",
                                                                                                       "Tasks.Actual_Create_Date__c",
                                                                                                       "Tasks.Contributor",
                                                                                                       "Tasks.Contributor_ID",
                                                                                                       "Tasks.DAS",
                                                                                                       "Tasks.Fiscal_Year",
                                                                                                       "Tasks.Promotion",
                                                                                                       "Tasks.Relative_Fiscal_Year",
                                                                                                       "Tasks.RH_Lev_1_GM_All__c",
                                                                                                       "Tasks.RH_Lev_2_DAS__c",
                                                                                                       "Tasks.RH_Lev_3_Region_2__c",
                                                                                                       "Tasks.RH_Lev_4_Region_1__c",
                                                                                                       "Tasks.RH_Lev_5_Country__c",
                                                                                                       "Tasks.RH_Lev_6_Office__c"
                                                                                                   ]
                                                                               },
                                                                "sources":  [
                                                                                "Task: Current FY: Flatten",
                                                                                "Task: Current FY: Flatten"
                                                                            ]
                                                            },
                  "Task: 2 FY Ago: Save Tasks":  {
                                                     "action":  "register",
                                                     "parameters":  {
                                                                        "label":  "TEST: Tasks: 2 Fiscal Years Ago",
                                                                        "name":  "TEST_Tasks_2_Fiscal_Years_Ago"
                                                                    },
                                                     "sources":  [
                                                                     "Task: 2 FY Ago: Keep Fields"
                                                                 ]
                                                 },
                  "Task: Previous FY: Export Promotion: Filter IsLastOrder":  {
                                                                                  "action":  "filter",
                                                                                  "parameters":  {
                                                                                                     "filter":  "IsLastOrder:EQ:true"
                                                                                                 },
                                                                                  "sources":  [
                                                                                                  "Task: Previous FY: Export Promotion: Add IsLastOrder"
                                                                                              ]
                                                                              },
                  "Task: Current FY: Investment Promotion: Add IsLastOrder":  {
                                                                                  "action":  "computeRelative",
                                                                                  "parameters":  {
                                                                                                     "computedFields":  [
                                                                                                                            {
                                                                                                                                "expression":  {
                                                                                                                                                   "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                                                   "type":  "Text"
                                                                                                                                               },
                                                                                                                                "label":  "Is Last Order",
                                                                                                                                "name":  "IsLastOrder"
                                                                                                                            }
                                                                                                                        ],
                                                                                                     "orderBy":  [
                                                                                                                     {
                                                                                                                         "direction":  "desc",
                                                                                                                         "name":  "Order"
                                                                                                                     }
                                                                                                                 ],
                                                                                                     "partitionBy":  [
                                                                                                                         "AccountId"
                                                                                                                     ]
                                                                                                 },
                                                                                  "sources":  [
                                                                                                  "Task: Current FY: Investment Promotion: Join flattened Task"
                                                                                              ]
                                                                              },
                  "Task: Previous FY: Add Order":  {
                                                       "action":  "computeRelative",
                                                       "parameters":  {
                                                                          "computedFields":  [
                                                                                                 {
                                                                                                     "expression":  {
                                                                                                                        "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                        "type":  "Numeric",
                                                                                                                        "scale":  10
                                                                                                                    },
                                                                                                     "label":  "Order",
                                                                                                     "name":  "Order"
                                                                                                 }
                                                                                             ],
                                                                          "orderBy":  [
                                                                                          {
                                                                                              "direction":  "asc",
                                                                                              "name":  "AccountId"
                                                                                          }
                                                                                      ],
                                                                          "partitionBy":  [
                                                                                              "AccountId"
                                                                                          ]
                                                                      },
                                                       "sources":  [
                                                                       "Task: Previous FY: Union Promotions"
                                                                   ]
                                                   },
                  "Task: 2 FY Ago: Investment Promotion: Join flattened Task":  {
                                                                                    "action":  "augment",
                                                                                    "parameters":  {
                                                                                                       "leftKey":  [
                                                                                                                       "Tasks"
                                                                                                                   ],
                                                                                                       "operation":  "LookupMultiValue",
                                                                                                       "relationship":  "Tasks",
                                                                                                       "rightKey":  [
                                                                                                                        "Flatten_Self_ID"
                                                                                                                    ],
                                                                                                       "rightSelect":  [
                                                                                                                           "Actual_Create_Date__c",
                                                                                                                           "Contributor",
                                                                                                                           "Contributor_ID",
                                                                                                                           "DAS",
                                                                                                                           "Fiscal_Year",
                                                                                                                           "Relative_Fiscal_Year",
                                                                                                                           "RH_Lev_1_GM_All__c",
                                                                                                                           "RH_Lev_2_DAS__c",
                                                                                                                           "RH_Lev_3_Region_2__c",
                                                                                                                           "RH_Lev_4_Region_1__c",
                                                                                                                           "RH_Lev_5_Country__c",
                                                                                                                           "RH_Lev_6_Office__c",
                                                                                                                           "Investment_Promotion__c",
                                                                                                                           "Promotion"
                                                                                                                       ]
                                                                                                   },
                                                                                    "sources":  [
                                                                                                    "Task: 2 FY Ago: Investment Promotion: Flatten",
                                                                                                    "Task: 2 FY Ago: Investment Promotion: Flatten"
                                                                                                ]
                                                                                },
                  "Task: 2 FY Ago: Export Promotion: Add Flatten IDs":  {
                                                                            "action":  "computeExpression",
                                                                            "parameters":  {
                                                                                               "computedFields":  [
                                                                                                                      {
                                                                                                                          "label":  "Flatten: Self ID",
                                                                                                                          "name":  "Flatten_Self_ID",
                                                                                                                          "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                                          "type":  "Text"
                                                                                                                      },
                                                                                                                      {
                                                                                                                          "label":  "Flatten: Parent ID",
                                                                                                                          "name":  "Flatten_Parent_ID",
                                                                                                                          "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                                          "type":  "Text"
                                                                                                                      }
                                                                                                                  ],
                                                                                               "mergeWithSource":  true
                                                                                           },
                                                                            "sources":  [
                                                                                            "Task: 2 FY Ago: Export Promotion: Add Order"
                                                                                        ]
                                                                        },
                  "Task: Load":  {
                                     "action":  "sobjectDigest",
                                     "parameters":  {
                                                        "fields":  [
                                                                       {
                                                                           "name":  "AccountId"
                                                                       },
                                                                       {
                                                                           "fiscalMonthOffset":  9,
                                                                           "name":  "Actual_Create_Date__c"
                                                                       },
                                                                       {
                                                                           "name":  "Id"
                                                                       },
                                                                       {
                                                                           "name":  "Investment_Promotion__c"
                                                                       },
                                                                       {
                                                                           "name":  "OwnerId"
                                                                       },
                                                                       {
                                                                           "name":  "Related_to_Case__c"
                                                                       },
                                                                       {
                                                                           "name":  "RH_Lev_1_GM_All__c"
                                                                       },
                                                                       {
                                                                           "name":  "RH_Lev_2_DAS__c"
                                                                       },
                                                                       {
                                                                           "name":  "RH_Lev_3_Region_2__c"
                                                                       },
                                                                       {
                                                                           "name":  "RH_Lev_4_Region_1__c"
                                                                       },
                                                                       {
                                                                           "name":  "RH_Lev_5_Country__c"
                                                                       },
                                                                       {
                                                                           "name":  "RH_Lev_6_Office__c"
                                                                       },
                                                                       {
                                                                           "name":  "IsDeleted"
                                                                       }
                                                                   ],
                                                        "incremental":  true,
                                                        "object":  "Task"
                                                    }
                                 },
                  "Task: Previous FY: Add IsLastOrder":  {
                                                             "action":  "computeRelative",
                                                             "parameters":  {
                                                                                "computedFields":  [
                                                                                                       {
                                                                                                           "expression":  {
                                                                                                                              "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                              "type":  "Text"
                                                                                                                          },
                                                                                                           "label":  "Is Last Order",
                                                                                                           "name":  "IsLastOrder"
                                                                                                       }
                                                                                                   ],
                                                                                "orderBy":  [
                                                                                                {
                                                                                                    "direction":  "desc",
                                                                                                    "name":  "Order"
                                                                                                }
                                                                                            ],
                                                                                "partitionBy":  [
                                                                                                    "AccountId"
                                                                                                ]
                                                                            },
                                                             "sources":  [
                                                                             "Task: Previous FY: Join flattened Task"
                                                                         ]
                                                         },
                  "Task: 2 FY Ago: Add Order":  {
                                                    "action":  "computeRelative",
                                                    "parameters":  {
                                                                       "computedFields":  [
                                                                                              {
                                                                                                  "expression":  {
                                                                                                                     "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                     "type":  "Numeric",
                                                                                                                     "scale":  10
                                                                                                                 },
                                                                                                  "label":  "Order",
                                                                                                  "name":  "Order"
                                                                                              }
                                                                                          ],
                                                                       "orderBy":  [
                                                                                       {
                                                                                           "direction":  "asc",
                                                                                           "name":  "AccountId"
                                                                                       }
                                                                                   ],
                                                                       "partitionBy":  [
                                                                                           "AccountId"
                                                                                       ]
                                                                   },
                                                    "sources":  [
                                                                    "Task: 2 FY Ago: Union Promotions"
                                                                ]
                                                },
                  "Task: Previous FY: Investment Promotion: Join flattened Task":  {
                                                                                       "action":  "augment",
                                                                                       "parameters":  {
                                                                                                          "leftKey":  [
                                                                                                                          "Tasks"
                                                                                                                      ],
                                                                                                          "operation":  "LookupMultiValue",
                                                                                                          "relationship":  "Tasks",
                                                                                                          "rightKey":  [
                                                                                                                           "Flatten_Self_ID"
                                                                                                                       ],
                                                                                                          "rightSelect":  [
                                                                                                                              "Actual_Create_Date__c",
                                                                                                                              "Contributor",
                                                                                                                              "Contributor_ID",
                                                                                                                              "DAS",
                                                                                                                              "Fiscal_Year",
                                                                                                                              "Relative_Fiscal_Year",
                                                                                                                              "RH_Lev_1_GM_All__c",
                                                                                                                              "RH_Lev_2_DAS__c",
                                                                                                                              "RH_Lev_3_Region_2__c",
                                                                                                                              "RH_Lev_4_Region_1__c",
                                                                                                                              "RH_Lev_5_Country__c",
                                                                                                                              "RH_Lev_6_Office__c",
                                                                                                                              "Investment_Promotion__c",
                                                                                                                              "Promotion"
                                                                                                                          ]
                                                                                                      },
                                                                                       "sources":  [
                                                                                                       "Task: Previous FY: Investment Promotion: Flatten",
                                                                                                       "Task: Previous FY: Investment Promotion: Flatten"
                                                                                                   ]
                                                                                   },
                  "Task: 2 FY Ago: Export Promotion: Filter IsLastOrder":  {
                                                                               "action":  "filter",
                                                                               "parameters":  {
                                                                                                  "filter":  "IsLastOrder:EQ:true"
                                                                                              },
                                                                               "sources":  [
                                                                                               "Task: 2 FY Ago: Export Promotion: Add IsLastOrder"
                                                                                           ]
                                                                           },
                  "Task: Previous FY: Add Flatten IDs":  {
                                                             "action":  "computeExpression",
                                                             "parameters":  {
                                                                                "computedFields":  [
                                                                                                       {
                                                                                                           "label":  "Flatten: Self ID",
                                                                                                           "name":  "Flatten_Self_ID",
                                                                                                           "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                           "type":  "Text"
                                                                                                       },
                                                                                                       {
                                                                                                           "label":  "Flatten: Parent ID",
                                                                                                           "name":  "Flatten_Parent_ID",
                                                                                                           "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                           "type":  "Text"
                                                                                                       }
                                                                                                   ],
                                                                                "mergeWithSource":  true
                                                                            },
                                                             "sources":  [
                                                                             "Task: Previous FY: Add Order"
                                                                         ]
                                                         },
                  "Task: Filter IsDeleted, GM All, Related to Case":  {
                                                                          "action":  "filter",
                                                                          "parameters":  {
                                                                                             "filter":  "IsDeleted:EQ:false,RH_Lev_1_GM_All__c:EQ:GM All,Related_to_Case__c:EQ:false"
                                                                                         },
                                                                          "sources":  [
                                                                                          "Task: Load"
                                                                                      ]
                                                                      },
                  "Task: Current FY: Add IsLastOrder":  {
                                                            "action":  "computeRelative",
                                                            "parameters":  {
                                                                               "computedFields":  [
                                                                                                      {
                                                                                                          "expression":  {
                                                                                                                             "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                             "type":  "Text"
                                                                                                                         },
                                                                                                          "label":  "Is Last Order",
                                                                                                          "name":  "IsLastOrder"
                                                                                                      }
                                                                                                  ],
                                                                               "orderBy":  [
                                                                                               {
                                                                                                   "direction":  "desc",
                                                                                                   "name":  "Order"
                                                                                               }
                                                                                           ],
                                                                               "partitionBy":  [
                                                                                                   "AccountId"
                                                                                               ]
                                                                           },
                                                            "sources":  [
                                                                            "Task: Current FY: Join flattened Task"
                                                                        ]
                                                        },
                  "Task: 2 FY Ago: Export Promotion: Add IsLastOrder":  {
                                                                            "action":  "computeRelative",
                                                                            "parameters":  {
                                                                                               "computedFields":  [
                                                                                                                      {
                                                                                                                          "expression":  {
                                                                                                                                             "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                                             "type":  "Text"
                                                                                                                                         },
                                                                                                                          "label":  "Is Last Order",
                                                                                                                          "name":  "IsLastOrder"
                                                                                                                      }
                                                                                                                  ],
                                                                                               "orderBy":  [
                                                                                                               {
                                                                                                                   "direction":  "desc",
                                                                                                                   "name":  "Order"
                                                                                                               }
                                                                                                           ],
                                                                                               "partitionBy":  [
                                                                                                                   "AccountId"
                                                                                                               ]
                                                                                           },
                                                                            "sources":  [
                                                                                            "Task: 2 FY Ago: Export Promotion: Join flattened Task"
                                                                                        ]
                                                                        },
                  "Task: Filter Current Fiscal Year":  {
                                                           "action":  "filter",
                                                           "parameters":  {
                                                                              "filter":  "Relative_Fiscal_Year:EQ:Current Fiscal Year"
                                                                          },
                                                           "sources":  [
                                                                           "Task: Filter Relative Fiscal Year"
                                                                       ]
                                                       },
                  "Task: 2 FY Ago: Export Promotion: Keep Fields":  {
                                                                        "action":  "sliceDataset",
                                                                        "parameters":  {
                                                                                           "fields":  [
                                                                                                          {
                                                                                                              "name":  "AccountId"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.Actual_Create_Date__c"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.Contributor"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.Contributor_ID"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.DAS"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.Fiscal_Year"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.Promotion"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.Relative_Fiscal_Year"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.RH_Lev_1_GM_All__c"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.RH_Lev_2_DAS__c"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.RH_Lev_3_Region_2__c"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.RH_Lev_4_Region_1__c"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.RH_Lev_5_Country__c"
                                                                                                          },
                                                                                                          {
                                                                                                              "name":  "Tasks.RH_Lev_6_Office__c"
                                                                                                          }
                                                                                                      ],
                                                                                           "mode":  "select"
                                                                                       },
                                                                        "sources":  [
                                                                                        "Task: 2 FY Ago: Export Promotion: Filter IsLastOrder"
                                                                                    ]
                                                                    },
                  "Task: 2 FY Ago: Union Promotions":  {
                                                           "action":  "append",
                                                           "parameters":  {
                                                                              "enableDisjointedSchemaMerge":  false
                                                                          },
                                                           "sources":  [
                                                                           "Task: 2 FY Ago: Export Promotion: Keep Fields",
                                                                           "Task: 2 FY Ago: Investment Promotion: Keep Fields"
                                                                       ]
                                                       },
                  "Task: 2 FY Ago: Keep Fields":  {
                                                      "action":  "sliceDataset",
                                                      "parameters":  {
                                                                         "fields":  [
                                                                                        {
                                                                                            "name":  "AccountId"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.Actual_Create_Date__c"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.Contributor"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.Contributor_ID"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.DAS"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.Fiscal_Year"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.Promotion"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.Relative_Fiscal_Year"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.RH_Lev_1_GM_All__c"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.RH_Lev_2_DAS__c"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.RH_Lev_3_Region_2__c"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.RH_Lev_4_Region_1__c"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.RH_Lev_5_Country__c"
                                                                                        },
                                                                                        {
                                                                                            "name":  "Related.Tasks.RH_Lev_6_Office__c"
                                                                                        }
                                                                                    ],
                                                                         "mode":  "select"
                                                                     },
                                                      "sources":  [
                                                                      "Task: 2 FY Ago: Filter IsLastOrder"
                                                                  ]
                                                  },
                  "Task: 2 FY Ago: Export Promotion: Add Order":  {
                                                                      "action":  "computeRelative",
                                                                      "parameters":  {
                                                                                         "computedFields":  [
                                                                                                                {
                                                                                                                    "expression":  {
                                                                                                                                       "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                                       "type":  "Numeric",
                                                                                                                                       "scale":  10
                                                                                                                                   },
                                                                                                                    "label":  "Order",
                                                                                                                    "name":  "Order"
                                                                                                                }
                                                                                                            ],
                                                                                         "orderBy":  [
                                                                                                         {
                                                                                                             "direction":  "asc",
                                                                                                             "name":  "Id"
                                                                                                         }
                                                                                                     ],
                                                                                         "partitionBy":  [
                                                                                                             "AccountId"
                                                                                                         ]
                                                                                     },
                                                                      "sources":  [
                                                                                      "Task: 2 FY Ago: Filter Export Promotion"
                                                                                  ]
                                                                  },
                  "Task: Current FY: Add Order":  {
                                                      "action":  "computeRelative",
                                                      "parameters":  {
                                                                         "computedFields":  [
                                                                                                {
                                                                                                    "expression":  {
                                                                                                                       "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                       "type":  "Numeric",
                                                                                                                       "scale":  10
                                                                                                                   },
                                                                                                    "label":  "Order",
                                                                                                    "name":  "Order"
                                                                                                }
                                                                                            ],
                                                                         "orderBy":  [
                                                                                         {
                                                                                             "direction":  "asc",
                                                                                             "name":  "AccountId"
                                                                                         }
                                                                                     ],
                                                                         "partitionBy":  [
                                                                                             "AccountId"
                                                                                         ]
                                                                     },
                                                      "sources":  [
                                                                      "Task: Current FY: Union Promotions"
                                                                  ]
                                                  },
                  "Task: Current FY: Export Promotion: Add Flatten IDs":  {
                                                                              "action":  "computeExpression",
                                                                              "parameters":  {
                                                                                                 "computedFields":  [
                                                                                                                        {
                                                                                                                            "label":  "Flatten: Self ID",
                                                                                                                            "name":  "Flatten_Self_ID",
                                                                                                                            "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                                            "type":  "Text"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "label":  "Flatten: Parent ID",
                                                                                                                            "name":  "Flatten_Parent_ID",
                                                                                                                            "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                                            "type":  "Text"
                                                                                                                        }
                                                                                                                    ],
                                                                                                 "mergeWithSource":  true
                                                                                             },
                                                                              "sources":  [
                                                                                              "Task: Current FY: Export Promotion: Add Order"
                                                                                          ]
                                                                          },
                  "Task: 2 FY Ago: Add IsLastOrder":  {
                                                          "action":  "computeRelative",
                                                          "parameters":  {
                                                                             "computedFields":  [
                                                                                                    {
                                                                                                        "expression":  {
                                                                                                                           "saqlExpression":  " case first(\u0027Order\u0027)\n    when current(\u0027Order\u0027) then \"true\"\n    else \"false\"\nend",
                                                                                                                           "type":  "Text"
                                                                                                                       },
                                                                                                        "label":  "Is Last Order",
                                                                                                        "name":  "IsLastOrder"
                                                                                                    }
                                                                                                ],
                                                                             "orderBy":  [
                                                                                             {
                                                                                                 "direction":  "desc",
                                                                                                 "name":  "Order"
                                                                                             }
                                                                                         ],
                                                                             "partitionBy":  [
                                                                                                 "AccountId"
                                                                                             ]
                                                                         },
                                                          "sources":  [
                                                                          "Task: 2 FY Ago: Join flattened Task"
                                                                      ]
                                                      },
                  "Task: 2 FY Ago: Filter Export Promotion":  {
                                                                  "action":  "filter",
                                                                  "parameters":  {
                                                                                     "filter":  "Promotion:EQ:Export Promotion"
                                                                                 },
                                                                  "sources":  [
                                                                                  "Task: Filter 2 Fiscal Years Ago"
                                                                              ]
                                                              },
                  "Task: Current FY: Save Tasks":  {
                                                       "action":  "register",
                                                       "parameters":  {
                                                                          "label":  "TEST: Tasks: Current Fiscal Year",
                                                                          "name":  "TEST_Tasks_Current_Fiscal_Year"
                                                                      },
                                                       "sources":  [
                                                                       "Task: Current FY: Keep Fields"
                                                                   ]
                                                   },
                  "Task: 2 FY Ago: Join flattened Task":  {
                                                              "action":  "augment",
                                                              "parameters":  {
                                                                                 "leftKey":  [
                                                                                                 "Tasks"
                                                                                             ],
                                                                                 "operation":  "LookupMultiValue",
                                                                                 "relationship":  "Related",
                                                                                 "rightKey":  [
                                                                                                  "Flatten_Self_ID"
                                                                                              ],
                                                                                 "rightSelect":  [
                                                                                                     "AccountId",
                                                                                                     "Tasks.Actual_Create_Date__c",
                                                                                                     "Tasks.Contributor",
                                                                                                     "Tasks.Contributor_ID",
                                                                                                     "Tasks.DAS",
                                                                                                     "Tasks.Fiscal_Year",
                                                                                                     "Tasks.Promotion",
                                                                                                     "Tasks.Relative_Fiscal_Year",
                                                                                                     "Tasks.RH_Lev_1_GM_All__c",
                                                                                                     "Tasks.RH_Lev_2_DAS__c",
                                                                                                     "Tasks.RH_Lev_3_Region_2__c",
                                                                                                     "Tasks.RH_Lev_4_Region_1__c",
                                                                                                     "Tasks.RH_Lev_5_Country__c",
                                                                                                     "Tasks.RH_Lev_6_Office__c"
                                                                                                 ]
                                                                             },
                                                              "sources":  [
                                                                              "Task: 2 FY Ago: Flatten",
                                                                              "Task: 2 FY Ago: Flatten"
                                                                          ]
                                                          },
                  "Task: Previous FY: Export Promotion: Add Flatten IDs":  {
                                                                               "action":  "computeExpression",
                                                                               "parameters":  {
                                                                                                  "computedFields":  [
                                                                                                                         {
                                                                                                                             "label":  "Flatten: Self ID",
                                                                                                                             "name":  "Flatten_Self_ID",
                                                                                                                             "saqlExpression":  "\u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027, \"0\")",
                                                                                                                             "type":  "Text"
                                                                                                                         },
                                                                                                                         {
                                                                                                                             "label":  "Flatten: Parent ID",
                                                                                                                             "name":  "Flatten_Parent_ID",
                                                                                                                             "saqlExpression":  "case\n    when \u0027Order\u0027 \u003e 1 then \u0027AccountId\u0027 + \":\" + number_to_string(\u0027Order\u0027 - 1, \"0\")\nend\n   ",
                                                                                                                             "type":  "Text"
                                                                                                                         }
                                                                                                                     ],
                                                                                                  "mergeWithSource":  true
                                                                                              },
                                                                               "sources":  [
                                                                                               "Task: Previous FY: Export Promotion: Add Order"
                                                                                           ]
                                                                           },
                  "Task: Current FY: Investment Promotion: Flatten":  {
                                                                          "action":  "flatten",
                                                                          "parameters":  {
                                                                                             "includeSelfId":  true,
                                                                                             "multiField":  {
                                                                                                                "name":  "Tasks"
                                                                                                            },
                                                                                             "parentField":  "Flatten_Parent_ID",
                                                                                             "pathField":  {
                                                                                                               "name":  "Tasks_Path"
                                                                                                           },
                                                                                             "selfField":  "Flatten_Self_ID"
                                                                                         },
                                                                          "sources":  [
                                                                                          "Task: Current FY: Investment Promotion: Add Flatten IDs"
                                                                                      ]
                                                                      },
                  "Task: Previous FY: Investment Promotion: Flatten":  {
                                                                           "action":  "flatten",
                                                                           "parameters":  {
                                                                                              "includeSelfId":  true,
                                                                                              "multiField":  {
                                                                                                                 "name":  "Tasks"
                                                                                                             },
                                                                                              "parentField":  "Flatten_Parent_ID",
                                                                                              "pathField":  {
                                                                                                                "name":  "Tasks_Path"
                                                                                                            },
                                                                                              "selfField":  "Flatten_Self_ID"
                                                                                          },
                                                                           "sources":  [
                                                                                           "Task: Previous FY: Investment Promotion: Add Flatten IDs"
                                                                                       ]
                                                                       },
                  "Task: 2 FY Ago: Investment Promotion: Add Order":  {
                                                                          "action":  "computeRelative",
                                                                          "parameters":  {
                                                                                             "computedFields":  [
                                                                                                                    {
                                                                                                                        "expression":  {
                                                                                                                                           "saqlExpression":  "case\n    when previous(\u0027Order\u0027) \u003e 0 then previous(\u0027Order\u0027) + 1\n    else 1\nend",
                                                                                                                                           "type":  "Numeric",
                                                                                                                                           "scale":  10
                                                                                                                                       },
                                                                                                                        "label":  "Order",
                                                                                                                        "name":  "Order"
                                                                                                                    }
                                                                                                                ],
                                                                                             "orderBy":  [
                                                                                                             {
                                                                                                                 "direction":  "asc",
                                                                                                                 "name":  "Id"
                                                                                                             }
                                                                                                         ],
                                                                                             "partitionBy":  [
                                                                                                                 "AccountId"
                                                                                                             ]
                                                                                         },
                                                                          "sources":  [
                                                                                          "Task: 2 FY Ago: Filter Investment Promotion"
                                                                                      ]
                                                                      }
              }
}
